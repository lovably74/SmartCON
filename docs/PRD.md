# SmartCON Lite 구축 상세 요구사항 정의서 (AI-Native)

**문서 버전:** 2.8  
**작성일:** 2025년 12월 17일  
**최종 수정일:** 2025년 12월 18일  
**작성자:** 경영기획실 이대영 이사  
**참고 화면:** 실제 SmartCON 운영 화면 (근로자 관리, 출역 관리, 인트로 페이지)  
**로고 이미지:** `docs/logo_main_white.png` (흰색 로고)  
**기반 문서:** `docs/smartcon_functional_spec_V2.md`, `docs/SmartCON_Lite_UI_Design_Guide.md`

---

## 1. 프로젝트 개요 (Project Overview)

본 프로젝트는 건설 현장의 인력 및 노무 관리를 위한 **'스마트콘 라이트(SmartCON Lite)'** SaaS 플랫폼을 구축하는 것을 목표로 합니다.  
구독형 모델을 기반으로 하며, 회사(Tenant) 단위의 데이터 격리와 역할별 최적화된 기능을 제공합니다.

### 핵심 목표
- **SaaS Platform**: 멀티테넌시(Multi-tenancy) 및 구독 결제/관리 시스템 구축
- **Role-Based Optimization**: 본사/현장/팀장/노무자 + **시스템 관리자(Super Admin)** 5단계 역할 지원
- **Automation**: 안면인식(FaceNet) 출역 자동화, 전자계약 원스톱 처리, 세금계산서 발행(API)
- **Mobile First**: 현장 중심의 하이브리드 앱 (React + Capacitor)

---

## 2. 기술 스택 (Tech Stack)

### 2.1 Backend
- **Language**: Java 17 (LTS)
- **Framework**: Spring Boot 3.3.x
- **Database**: MariaDB 10.11 (JPA/Hibernate) - Multi-tenant Schema
- **Batch**: Spring Batch (안면인식 데이터 동기화, 구독 결제/정산)
- **Security**: Spring Security 6.x + JWT + OAuth2 Client
- **Infrastructure**: Docker, AWS (S3 for files)

### 2.2 Frontend (Web & Mobile WebApp)
- **Framework**: React 18 + TypeScript + Vite
- **State Mgmt**: TanStack Query + Zustand
- **UI System**: **Shadcn/UI** + **Tailwind CSS** (Custom Design System applied)
- **Mobile Bridge**: Capacitor (Camera, Geolocation, Push, Deep Link)

### 2.3 External Interfaces
- **Face Recognition**: FaceNet (Face Embedding & Matching Server)
- **Weather**: OpenWeatherMap / KMA API
- **Direct Messaging**: SMS/AlimTalk Gateway (BizMsg etc.)
- **Payment & Tax**: PG사 연동 (Subscription) + 홈택스 연동 API (Tax Invoice)

### 2.4 UI/UX 요구사항 (PC Web & Mobile WebApp)

#### 2.4.1. 색상 원칙 (눈이 편안한 화면)

- **배경(큰 면적)**: `#FAFAFA`(Off-White) 기반의 중립 배경을 기본값으로 사용
- **Surface(카드/모달)**: `#FFFFFF`
- **Primary(회사 주색상)**: `#71AA44`(CMYK 55 10 95 00 기반)  
  - **사용 위치 제한**: 핵심 CTA/활성 상태/중요 강조(포인트) 중심으로만 사용  
  - **대면적 채움 금지**: 강한 색(노랑/형광/순색) 및 Primary 풀배경은 눈부심 유발 → 금지
- **텍스트 대비**: 본문은 다크 그레이 계열(예: `#262626`), 보조 텍스트는 중간 회색(예: `#737373`)로 가독성 확보

#### 2.4.2. 내비게이션 구조 (직관성)

- **PC Web**:
  - 좌측 **접기/펼치기 가능한 사이드바**(아이콘+라벨, 역할별 메뉴) + 상단 헤더(페이지 타이틀/아이콘) 구조
  - **대시보드는 메뉴에서 제거**하고, **로그인 후 최초 진입 화면은 대시보드**로 고정
  - 좌측 상단 **SmartCON 로고 클릭 시 현재 역할의 대시보드로 이동** (빠른 “홈” 동작)
  - 상단 헤더 우측에 **다국어/현장변경/알림** 아이콘 클러스터 배치 (일관된 위치)
- **Mobile Web**:
  - 하단 **Bottom Navigation(핵심 4개 탭)** + 상단 **Sticky Header** + 선택/상세는 **Bottom Sheet** 패턴 권장
  - **홈 탭은 대시보드로 이동** (항상 “첫 화면”으로 복귀)

#### 2.4.3. 대시보드(위젯형) 구성

- 대시보드는 “정보 스캔”에 최적화된 **위젯(Widget) 조합**으로 구성
  - KPI 카드(아이콘+수치+보조지표)
  - 리스트/요약 위젯(예: 현장별 출역 현황, 미서명 계약 현황)
  - 상태 색상은 Success/Warning/Destructive 범위로 제한

#### 2.4.4. 접근성/사용성 (필수)

- **키보드 포커스/링** 제공, 터치 타겟 최소 44px 권장
- **WCAG 2.1 AA** 대비 준수 (텍스트/아이콘/상태색)
- 로딩/빈 상태/오류 상태 UI 제공 (스켈레톤/토스트/에러 안내)

#### 2.4.5. 메뉴 정보구조(IA) 재편안 (문서 기준)

본 IA는 **PC Web(사이드바 중심)**과 **Mobile Web(하단 탭 중심)**을 분리하여 사용자의 인지 부하를 낮추고, 역할별 업무 흐름을 직관적으로 제공합니다.

##### 안 A: 역할(Role) 중심 IA (권장, 1차)

- **원칙**
  - 로그인 후 선택된 역할(ROLE_HQ/ROLE_SITE/ROLE_TEAM/ROLE_WORKER/ROLE_SUPER)에 따라 **메뉴가 완전히 분기**됩니다.
  - PC는 좌측 사이드바에 “대메뉴 5~7개”만 노출하고, 상세 기능은 화면 내 탭/필터로 확장합니다.
  - Mobile Web은 **핵심 4탭**으로 고정하고 나머지는 “더보기/설정”에 집약합니다.

- **PC Web (예시)**  
  - **정책**: **대시보드는 로그인 후 최초 화면**이며, **메뉴에는 노출하지 않음**. “홈” 동작은 **SmartCON 로고 클릭**으로 제공.
  - **본사 관리자(HQ)**: 현장 / 노무 / 계약 / 정산 / 설정
  - **현장 관리자(Site)**: 출역 / 작업일보 / 계약 / 팀·노무자 / 정산
  - **팀장(Team)**: 작업요청 / 일보제출 / 출역 / 계약 / 내정보
  - **노무자(Worker)**: 출역조회 / 계약서 / 내정보

- **Mobile Web (핵심 4탭 권장)**  
  - **홈(대시보드)** / **출역** / **계약** / **내정보** (**홈 탭 = 대시보드**)
  - 팀장 전용(일보/작업요청 등)은 홈 상단 “빠른 작업(Quick Actions)” 위젯으로 노출

##### 안 B: 업무(Task) 중심 IA (확장안, 2차)

- **원칙**
  - “현장 운영” 관점에서 공통 업무를 중심으로 **역할별로 기능 접근을 제한**합니다.
  - 동일 메뉴명/위치로 학습 비용을 낮추되, 역할별로 보이는 카드/액션을 다르게 합니다.

- **PC Web (예시)**
  - **홈(대시보드)** / **현장** / **출역** / **작업일보** / **계약** / **정산** / **관리(설정/권한)**

- **Mobile Web (핵심 4탭 유지)**
  - **홈** / **출역** / **계약** / **내정보**
  - “현장/작업일보/정산”은 홈의 위젯(카드)에서 진입 또는 더보기로 제공

---

## 3. 사용자 역할 및 권한 (User Roles)

### 3.1. 슈퍼 어드민 (Super Admin / SaaS Admin)
- **권한**: 플랫폼 운영의 최상위 관리자
- **주요 기능**:
  - **Tenant 관리**: 가입 회사 현황, 서비스 상태(활성/중지) 관리
  - **구독/결제 모니터링**: 자동 결제 현황, 미수금 관리
  - **정산/세무**: 세금계산서 자동 발행 내역 확인, 국세청 전송 상태 모니터링

### 3.2. 본사 관리자 (HQ Administrator / Tenant Admin)
- **인증**: 인트로 페이지 -> 로그인 버튼 -> 본사 관리자 로그인 선택 -> ID(사업자번호) + 비밀번호
- **주요 기능**:
  - **회사/현장 관리**: 현장 개설 및 관리자 초대
  - **기준 정보**: 공종, 장비, 노무 단가 표준 설정
  - **구독 관리**: 요금제 변경, 결제 수단 등록, 청구서 조회
  - **전사 대시보드**: 현장별 공정률, 출역 인원, 계약 체결률 모니터링

### 3.3. 현장 관리자 (Site Manager)
- **인증**: 인트로 페이지 -> 로그인 버튼 -> 소셜 로그인 선택 -> 소셜 로그인 (Kakao, Naver) -> 현장 선택
- **주요 기능**:
  - **운영/설정**: 현장 전용 공종/장비 설정, 안면인식기 관리
  - **작업 관리**: 작업 팀 배정(Request), 출역 마감(Approval)
  - **공사일보**: 날씨 자동 연동, 공종별 인원/장비 취합 및 승인
  - **노무 관리**: 미서명 근로계약서 일괄 요청

### 3.4. 노무 팀장 (Team Leader)
- **인증**: 인트로 페이지 -> 로그인 버튼 -> 소셜 로그인 선택 -> 소셜 로그인 -> 현장 선택
- **주요 기능**:
  - **팀 관리**: 팀원 초대(Link/SMS) 및 승인
  - **작업 수행**: 현장 작업 요청 수락/거부, 내일 투입 인원 보고
  - **출역 관리**: 팀원 출역 현황 확인 및 이의 제기, 근로계약 독려

### 3.5. 노무자 (Worker)
- **인증**: 인트로 페이지 -> 로그인 버튼 -> 소셜 로그인 선택 -> 소셜 로그인 -> 현장 선택
- **주요 기능**:
  - **출역 조회**: 일별/월별 공수 및 예상 노임 확인
  - **전자 계약**: 근로계약서 전자 서명 (Canvas)
  - **내 정보**: 안면인식 사진 등록, 계좌번호 관리

---

## 4. 핵심 프로세스 및 기능 명세

### 4.1. 구독 및 테넌트 온보딩 (SaaS Onboarding)
1.  **신청**: 사업자번호 인증 -> 회원가입 (법인/개인사업자)
2.  **구독 설정**: 요금제 선택 -> 결제 수단(카드/CMS) 등록
3.  **개통**: Tenant 생성 및 HQ Admin 계정 활성화 -> 즉시 이용 가능

### 4.2. 안면인식 데이터 파이프라인 (FaceNet Flow)
- **등록**: 사용자 앱에서 셀카 등록 -> SmartCON 서버 저장 -> FaceNet 서버로 임베딩 요청
- **활성화 (Daily Batch)**:
  - 매일 자정 (`00:00`) 실행
  - 금일 작업 투입 예정인 사용자(`WorkAssignment` 승인 건) 필터링
  - 해당 사용자의 Face Embedding 데이터를 안면인식기(Edge/Cloud) 활성 리스트에 로드
- **삭제**: 투입 기간 종료 시 활성 리스트에서 제거 (개인정보 보호)

### 4.3. 작업 배정 및 일보 취합 (Work & Report)
- **작업 요청**: Site Mgr가 '내일'의 공종/위치/인원을 특정 팀에게 요청
- **수락/거부**: Team Lead가 요청 확인 후 수락 여부 결정 (Push 알림)
- **일보 자동화**:
  - 오후 5시 등 특정 시점에 Team Lead가 제출한 투입 내역 집계
  - 기상청 API로 날씨/기온 자동 입력
  - Site Mgr는 집계된 데이터를 바탕으로 수정/보완 후 최종 승인

### 4.4. 전자근로계약 (E-Contract)
- **자동 생성**: 출역 확정 시 표준근로계약서 템플릿에 데이터 바인딩
- **서명 프로세스**:
  - 노무자 앱에서 '서명 필요' 알림 수신
  - 계약서 내용 확인 후 전자 서명 패드 서명
  - PDF 변환 후 S3 저장 및 Hash 값 DB 기록 (위변조 방지)

---

## 5. 인증 플로우 (Authentication Flow)

### 5.1. 인트로 페이지 (Landing Page)
- **경로**: `/` (루트 경로)
- **목적**: 서비스 소개 및 로그인 진입점 제공
- **구성 요소**:
  - 메인 메시지: "안전관리, 이제는 스마트하게!"
  - 서브 메시지: "본사와 현장관리까지 한 번에 업무 끝! 스마트콘 [SmartCON]"
  - 로그인 버튼: 로그인 방식 선택 페이지로 이동
  - 문의 및 데모신청 섹션(필수): 문의 폼 제공
- **디자인 기준**: [`ismartcon.net 인트로`](https://www.ismartcon.net/login/smart/index) 구성(메뉴 라벨/섹션/푸터 정보 포함)과 동일하게 구현

#### 5.1.1. 인트로 상단 메뉴(PC)

- **메뉴 라벨(고정)**:
  - 비대면바우처(배지)
  - 스마트콘 소개
  - 스마트콘 핵심기능
  - 서비스요금
  - 문의하기
  - 로그인
- **모바일**: 상단은 로그인 버튼 중심으로 단순화하고, 섹션 이동은 스크롤/CTA로 제공

#### 5.1.2. 문의 및 데모신청(폼) 요구사항

- **필드(동일)**:
  - 회사명
  - 담당자성함/직책
  - 연락처
  - 이메일
  - 로봇방지질문(간단 합계)
  - 개인정보 수집 및 이용 동의(필수)
  - 마케팅 수집 및 활용동의(선택)
  - 문의내용
- **반응형**:
  - Mobile: 단일 컬럼(세로 스택)
  - Desktop: 2컬럼(입력/문의내용 분리)

### 5.2. 로그인 방식 선택
- **경로**: `/login`
- **기능**: 사용자가 로그인 방식을 선택
  - **본사 관리자 로그인**: ID(사업자번호) + 비밀번호 방식
  - **소셜 로그인**: Kakao, Naver 소셜 로그인

### 5.3. 본사 관리자 로그인
- **경로**: `/login/hq`
- **인증 방식**: 사업자번호(ID) + 비밀번호

### 5.4. 소셜 로그인
- **경로**: `/login/social`
- **인증 방식**: Kakao, Naver OAuth2
- **후속 처리**: 로그인 성공 후 현장 선택 또는 역할 선택

---

## 6. 비기능 요구사항
- **딥링크 (Deep Linking)**: SMS 초대 링크 클릭 시 -> 앱 미설치 시 스토어 이동 / 설치 시 앱 실행 후 해당 화면(초대 수락)으로 직행
- **반응형 웹**: PC(1920px), Tablet(768px), Mobile(375px) 대응 (Mobile First Design)
- **보안**: 개인정보(주민번호, 계좌) 마스킹 및 DB 암호화, SSL 적용, 세션 타임아웃(30분)
- **다국어**: i18n 적용 (한국어, 영어 기본 지원)

---
